-- =========================
-- POTATO FPS MODE (ALL IN ONE)
-- UI + CUTSCENE + DIALOG SAFE
-- =========================

repeat task.wait() until game:IsLoaded()

-- ===== INI SETTING =====
_G.INI = {
    FPS_CAP = 30,          -- 30 / 60 / 120
    LOW_RENDER = true,
    NO_SHADOW = true,
    LOW_WATER = true,

    POTATO_WORLD = true,
    POTATO_CHARACTER = true,
    REMOVE_EFFECT = true,
    REMOVE_CLOTHES = true
}

-- ===== SERVICES =====
local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local Terrain = workspace:FindFirstChildOfClass("Terrain")
local StarterGui = game:GetService("StarterGui")
local LocalPlayer = Players.LocalPlayer

pcall(function()
    StarterGui:SetCore("SendNotification", {
        Title = "POTATO MODE",
        Text = "FADLI MOD",
        Duration = 3
    })
end)

-- ===== FPS =====
if setfpscap and _G.INI.FPS_CAP then
    setfpscap(_G.INI.FPS_CAP)
end

-- ===== LOW RENDER =====
if _G.INI.LOW_RENDER then
    settings().Rendering.QualityLevel = 0
    settings().Rendering.MeshPartDetailLevel = Enum.MeshPartDetailLevel.Level04
end

-- ===== NO SHADOW =====
if _G.INI.NO_SHADOW then
    Lighting.GlobalShadows = false
    Lighting.ShadowSoftness = 0
    Lighting.FogEnd = 9e9
end

-- ===== LOW WATER =====
if Terrain and _G.INI.LOW_WATER then
    Terrain.WaterWaveSize = 0
    Terrain.WaterWaveSpeed = 0
    Terrain.WaterReflectance = 0
    Terrain.WaterTransparency = 0
end

-- ===== SAFE CHECK =====
local function UISafe(inst)
    return inst:IsDescendantOf(LocalPlayer:WaitForChild("PlayerGui"))
        or inst:IsA("ScreenGui")
        or inst:IsA("BillboardGui")
        or inst:IsA("SurfaceGui")
end

local function CutsceneSafe(inst)
    return inst:IsA("Camera")
        or inst:IsA("Animation")
        or inst:IsA("Animator")
end

-- ===== POTATO CORE =====
local function Potato(inst)
    if UISafe(inst) or CutsceneSafe(inst) then return end

    -- REMOVE EFFECT
    if _G.INI.REMOVE_EFFECT then
        if inst:IsA("ParticleEmitter")
        or inst:IsA("Trail")
        or inst:IsA("Smoke")
        or inst:IsA("Fire")
        or inst:IsA("Sparkles")
        or inst:IsA("Explosion")
        or inst:IsA("PostEffect") then
            inst:Destroy()
            return
        end
    end

    -- REMOVE CLOTHES / SKIN
    if _G.INI.REMOVE_CLOTHES then
        if inst:IsA("Shirt")
        or inst:IsA("Pants")
        or inst:IsA("ShirtGraphic")
        or inst:IsA("Accessory")
        or inst:IsA("Hat")
        or inst:IsA("Face")
        or inst:IsA("SurfaceAppearance") then
            inst:Destroy()
            return
        end
    end

    -- TEXTURE POTATO
    if inst:IsA("Decal") or inst:IsA("Texture") then
        inst.Texture = ""
    end

    if inst:IsA("SpecialMesh") then
        inst.MeshId = ""
        inst.TextureId = ""
    end

    -- PART / NPC / CHARACTER POTATO
    if inst:IsA("BasePart") then
        inst.Material = Enum.Material.Plastic
        inst.Reflectance = 0
    end

    if inst:IsA("MeshPart") then
        inst.Material = Enum.Material.Plastic
        inst.Reflectance = 0
        inst.TextureID = ""
        inst.RenderFidelity = 0
    end
end

-- ===== APPLY =====
for _, v in ipairs(game:GetDescendants()) do
    pcall(Potato, v)
end

game.DescendantAdded:Connect(function(v)
    task.wait(0.2)
    pcall(Potato, v)
end)

warn("POTATO FPS MODE LOADED (ALL IN ONE)")
